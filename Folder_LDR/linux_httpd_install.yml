---
- name: Install HTTPD using Ansible Playbook
  hosts: All
  become: true
  
  tasks:
    - name: Install HTTPD package
      package:
        name: httpd
        state: present
    - name: Start HTTPD service
      service:
        name: httpd
        state: started
        enabled: yes
    - name: Validar servicio
      shell: systemctl status httpd
      register: httpd_status
      ignore_errors: yes
    - name: Result
      set_fact:
        servicio_resultado: "{{ 'Servicio Existe' if httpd_status.rc == 0 else 'Servicio No existe' }}"
    - name: Modulo de env√≠o de correo
      mail:
        host: "{{ correo_servidor }}"
        port: "{{ port_servidor }}"
        username: "{{ user_mailserver }}"
        password: "{{ passwd_mailserver }}"
        to: "{{ correo_to }}"
        from: "{{ correo_from }}"
        subject: "Install httpd"
        body: |
          Estado de HTTPD Fecha: {{ ansible_date_time.date }} - {{ servicio_resultado }}.
      delegate_to: localhost